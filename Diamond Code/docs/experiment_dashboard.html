<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VRAXION Experiment Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #0d1117; color: #c9d1d9; font-family: 'Consolas', 'SF Mono', monospace; padding: 20px; }
  h1 { color: #58a6ff; margin-bottom: 8px; font-size: 1.4em; }
  h2 { color: #8b949e; margin: 24px 0 12px; font-size: 1.1em; border-bottom: 1px solid #21262d; padding-bottom: 6px; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
  .card { background: #161b22; border: 1px solid #21262d; border-radius: 8px; padding: 16px; }
  .card.full { grid-column: 1 / -1; }
  canvas { width: 100% !important; max-height: 400px; }
  .meta { color: #8b949e; font-size: 0.8em; margin-bottom: 12px; }
  .insight { background: #1c2333; border-left: 3px solid #f0883e; padding: 10px 14px; margin: 12px 0; font-size: 0.85em; }
  .insight strong { color: #f0883e; }
  table { width: 100%; border-collapse: collapse; font-size: 0.8em; margin-top: 8px; }
  th { text-align: left; color: #8b949e; padding: 6px 8px; border-bottom: 1px solid #21262d; }
  td { padding: 6px 8px; border-bottom: 1px solid #161b22; }
  .val { color: #7ee787; font-weight: bold; }
  .dim { color: #484f58; }
  .tabs { display: flex; gap: 4px; margin-bottom: 12px; }
  .tab { padding: 6px 14px; background: #21262d; border: none; color: #8b949e; cursor: pointer; border-radius: 6px; font-family: inherit; font-size: 0.85em; }
  .tab.active { background: #388bfd26; color: #58a6ff; }
  .heatmap { display: grid; grid-template-columns: auto repeat(8, 1fr); gap: 2px; font-size: 0.75em; }
  .heatcell { padding: 6px 4px; text-align: center; border-radius: 3px; }
  .heatlabel { padding: 6px 8px; text-align: right; color: #8b949e; }
  .subtitle { color: #8b949e; font-size: 0.85em; margin-bottom: 16px; }
</style>
</head>
<body>

<h1>VRAXION Experiment Dashboard</h1>
<p class="subtitle">All training runs, all dimensions. Updated 2026-02-22.</p>

<div class="grid">

<!-- 1. LEARNING CURVES -->
<div class="card full">
  <h2>Learning Curves — Eval Bit Accuracy vs Steps</h2>
  <div class="tabs">
    <button class="tab active" onclick="showCurves('all')">All Runs</button>
    <button class="tab" onclick="showCurves('fineweb')">fineweb_edu only</button>
    <button class="tab" onclick="showCurves('cpu')">CPU only</button>
  </div>
  <canvas id="learningCurves" height="350"></canvas>
</div>

<!-- 2. PARAMS vs ACCURACY -->
<div class="card">
  <h2>Params vs Eval Accuracy</h2>
  <p class="meta">Does model size matter? (log scale X)</p>
  <canvas id="paramsVsAcc" height="300"></canvas>
</div>

<!-- 3. PER-BIT HEATMAP -->
<div class="card">
  <h2>Per-Bit Accuracy Heatmap</h2>
  <p class="meta">Which bits are easy/hard across experiments</p>
  <div id="heatmap"></div>
</div>

<!-- 4. ARCHITECTURE COMPARISON -->
<div class="card">
  <h2>Architecture Comparison (500 steps)</h2>
  <p class="meta">Overnight depth probe — same data, same steps</p>
  <canvas id="archCompare" height="300"></canvas>
</div>

<!-- 5. LOSS CURVES -->
<div class="card">
  <h2>Eval Loss Trajectories</h2>
  <canvas id="lossCurves" height="300"></canvas>
</div>

<!-- 6. BYTE ACCURACY -->
<div class="card full">
  <h2>Byte Match Accuracy (all 8 bits correct)</h2>
  <p class="meta">Harder metric — predicting the exact character</p>
  <canvas id="byteCurves" height="250"></canvas>
</div>

<!-- 7. LCX DELTA (GPU) -->
<div class="card">
  <h2>LCX Delta (GPU) — Is Memory Helping?</h2>
  <p class="meta">Negative = LCX reduces loss. Closer to 0 = no effect.</p>
  <canvas id="lcxDelta" height="300"></canvas>
</div>

<!-- 8. INSIGHTS -->
<div class="card">
  <h2>Key Observations</h2>
  <div class="insight"><strong>79% Wall:</strong> CPU (515K) and GPU (50M) both plateau at ~79% eval. 100x params, same ceiling.</div>
  <div class="insight"><strong>Depth longrun:</strong> D=2000 depth=2 reaches 84.4% at 2000 steps — still climbing. NOT plateaued.</div>
  <div class="insight"><strong>LCX helps:</strong> CPU Beta +13.1% over Alpha baseline (65.9%→79.0%). lcx_delta consistently negative on GPU.</div>
  <div class="insight"><strong>tt=2 shock:</strong> Switching to tt=2 drops eval 67.2% (from 79%), recovers to 75% in 175 steps. Still below tt=1.</div>
  <div class="insight"><strong>Bit 0-2 solved:</strong> Structure bits (ASCII, case, vowel group) at 96-100% everywhere.</div>
  <div class="insight"><strong>Bit 5 hardest:</strong> 50/50 distribution in English — pure language modelling metric.</div>
  <div class="insight"><strong>depth=4 hurts:</strong> In overnight probe, depth=4 < depth=2 at 500 steps. But longrun shows depth=2 still climbing at 2000 steps.</div>
</div>

<!-- 9. EXPERIMENT TABLE -->
<div class="card full">
  <h2>All Experiments Summary</h2>
  <table>
    <tr>
      <th>Experiment</th><th>D</th><th>depth</th><th>tt</th><th>LCX</th>
      <th>Params</th><th>Task</th><th>Steps</th><th>Eval Acc</th><th>Eval Loss</th><th>Byte Acc</th>
    </tr>
    <tr><td>CPU Alpha</td><td>618</td><td>2</td><td>0</td><td>OFF</td><td class="val">406K</td><td>fineweb</td><td>2300</td><td class="val">79.5%</td><td>0.541</td><td>—</td></tr>
    <tr><td>CPU Beta (tt=1)</td><td>618</td><td>2</td><td>1</td><td>ON</td><td class="val">515K</td><td>fineweb</td><td>1100</td><td class="val">79.1%</td><td>0.522</td><td>25.0%</td></tr>
    <tr><td>CPU tt=2</td><td>618</td><td>2</td><td>2</td><td>ON</td><td class="val">515K</td><td>fineweb</td><td>200*</td><td class="val">75.2%</td><td>0.562</td><td>10.0%</td></tr>
    <tr><td>GPU gate-free</td><td>6180</td><td>2</td><td>1</td><td>ON</td><td class="val">50M</td><td>fineweb</td><td>2075</td><td class="val">~78.5%</td><td>0.544</td><td>~18%</td></tr>
    <tr><td>Depth2 longrun</td><td>2000</td><td>2</td><td>1</td><td>ON</td><td class="val">4.1M</td><td>fineweb</td><td>2000</td><td class="val">84.4%</td><td>0.469</td><td>41.8%</td></tr>
    <tr><td>Overnight d=1</td><td>2000</td><td>1</td><td>1</td><td>ON</td><td class="dim">72K</td><td>fineweb</td><td>500</td><td>74.1%</td><td>0.573</td><td>6.2%</td></tr>
    <tr><td>Overnight d=2</td><td>2000</td><td>2</td><td>1</td><td>ON</td><td class="dim">4.1M</td><td>fineweb</td><td>500</td><td>75.9%</td><td>0.555</td><td>10.2%</td></tr>
    <tr><td>Overnight d=4</td><td>2000</td><td>4</td><td>1</td><td>ON</td><td class="dim">12M</td><td>fineweb</td><td>500</td><td>74.2%</td><td>0.571</td><td>6.2%</td></tr>
    <tr><td>Overnight D=4000</td><td>4000</td><td>2</td><td>1</td><td>ON</td><td class="dim">16M</td><td>fineweb</td><td>500</td><td>74.7%</td><td>0.566</td><td>9.9%</td></tr>
  </table>
</div>

</div>

<script>
// ============================================================
// DATA
// ============================================================

const cpuBeta = [{"step":25,"acc":0.721},{"step":50,"acc":0.704},{"step":75,"acc":0.717},{"step":100,"acc":0.738},{"step":125,"acc":0.737},{"step":150,"acc":0.741},{"step":175,"acc":0.738},{"step":200,"acc":0.746},{"step":225,"acc":0.747},{"step":250,"acc":0.749},{"step":275,"acc":0.745},{"step":300,"acc":0.749},{"step":325,"acc":0.746},{"step":350,"acc":0.753},{"step":375,"acc":0.752},{"step":400,"acc":0.755},{"step":425,"acc":0.758},{"step":450,"acc":0.763},{"step":475,"acc":0.768},{"step":500,"acc":0.758},{"step":525,"acc":0.767},{"step":550,"acc":0.77},{"step":575,"acc":0.773},{"step":600,"acc":0.773},{"step":625,"acc":0.777},{"step":650,"acc":0.777},{"step":675,"acc":0.773},{"step":700,"acc":0.777},{"step":725,"acc":0.779},{"step":750,"acc":0.78},{"step":775,"acc":0.778},{"step":800,"acc":0.779},{"step":825,"acc":0.785},{"step":850,"acc":0.786},{"step":875,"acc":0.784},{"step":900,"acc":0.785},{"step":925,"acc":0.788},{"step":950,"acc":0.787},{"step":975,"acc":0.785},{"step":1000,"acc":0.786},{"step":1025,"acc":0.789},{"step":1050,"acc":0.79},{"step":1075,"acc":0.79},{"step":1100,"acc":0.791}];

const cpuBetaLoss = [{"step":25,"loss":0.5918,"byte":0.013},{"step":50,"loss":0.6096,"byte":0.043},{"step":75,"loss":0.5966,"byte":0.038},{"step":100,"loss":0.5749,"byte":0.032},{"step":150,"loss":0.5719,"byte":0.042},{"step":200,"loss":0.5673,"byte":0.067},{"step":250,"loss":0.5644,"byte":0.082},{"step":300,"loss":0.5646,"byte":0.08},{"step":350,"loss":0.5604,"byte":0.096},{"step":400,"loss":0.5581,"byte":0.109},{"step":450,"loss":0.55,"byte":0.137},{"step":500,"loss":0.5552,"byte":0.152},{"step":550,"loss":0.5436,"byte":0.153},{"step":600,"loss":0.5401,"byte":0.157},{"step":650,"loss":0.5367,"byte":0.197},{"step":700,"loss":0.5365,"byte":0.203},{"step":750,"loss":0.5335,"byte":0.201},{"step":800,"loss":0.5343,"byte":0.206},{"step":850,"loss":0.5269,"byte":0.218},{"step":900,"loss":0.5286,"byte":0.227},{"step":950,"loss":0.5259,"byte":0.231},{"step":1000,"loss":0.5268,"byte":0.235},{"step":1050,"loss":0.523,"byte":0.244},{"step":1100,"loss":0.5221,"byte":0.25}];

const cpuTt2 = [{"step":25,"acc":0.737},{"step":50,"acc":0.743},{"step":75,"acc":0.744},{"step":100,"acc":0.752},{"step":125,"acc":0.749},{"step":150,"acc":0.749},{"step":175,"acc":0.749},{"step":200,"acc":0.752}];

// Depth2 longrun (D=2000, depth=2, fineweb)
const depth2Longrun = [{"step":50,"acc":0.7438,"loss":0.5694,"byte":0.0563},{"step":100,"acc":0.7461,"loss":0.5672,"byte":0.0452},{"step":150,"acc":0.7492,"loss":0.5641,"byte":0.0495},{"step":200,"acc":0.7537,"loss":0.5596,"byte":0.0727},{"step":250,"acc":0.7575,"loss":0.5557,"byte":0.0848},{"step":300,"acc":0.7584,"loss":0.5549,"byte":0.1077},{"step":350,"acc":0.7618,"loss":0.5514,"byte":0.1021},{"step":400,"acc":0.7682,"loss":0.5451,"byte":0.1155},{"step":450,"acc":0.7682,"loss":0.545,"byte":0.1292},{"step":500,"acc":0.7752,"loss":0.5381,"byte":0.1555},{"step":550,"acc":0.7788,"loss":0.5344,"byte":0.1727},{"step":600,"acc":0.789,"loss":0.5242,"byte":0.1966},{"step":650,"acc":0.7898,"loss":0.5234,"byte":0.2034},{"step":700,"acc":0.7958,"loss":0.5175,"byte":0.2149},{"step":750,"acc":0.8005,"loss":0.5128,"byte":0.2306},{"step":800,"acc":0.8049,"loss":0.5083,"byte":0.2684},{"step":850,"acc":0.8067,"loss":0.5066,"byte":0.2615},{"step":900,"acc":0.8116,"loss":0.5017,"byte":0.2862},{"step":950,"acc":0.8116,"loss":0.5017,"byte":0.2925},{"step":1000,"acc":0.8141,"loss":0.4991,"byte":0.3086},{"step":1050,"acc":0.817,"loss":0.4963,"byte":0.3035},{"step":1100,"acc":0.8185,"loss":0.4948,"byte":0.3266},{"step":1150,"acc":0.826,"loss":0.4872,"byte":0.3411},{"step":1200,"acc":0.8316,"loss":0.4816,"byte":0.3641},{"step":1250,"acc":0.8278,"loss":0.4854,"byte":0.3449},{"step":1300,"acc":0.8307,"loss":0.4826,"byte":0.3536},{"step":1350,"acc":0.8314,"loss":0.4818,"byte":0.3626},{"step":1400,"acc":0.8302,"loss":0.483,"byte":0.3631},{"step":1450,"acc":0.8278,"loss":0.4855,"byte":0.3535},{"step":1500,"acc":0.8409,"loss":0.4723,"byte":0.3998},{"step":1550,"acc":0.8365,"loss":0.4767,"byte":0.3812},{"step":1600,"acc":0.8305,"loss":0.4827,"byte":0.3685},{"step":1650,"acc":0.8393,"loss":0.474,"byte":0.3949},{"step":1700,"acc":0.8413,"loss":0.4719,"byte":0.403},{"step":1750,"acc":0.8404,"loss":0.4728,"byte":0.4055},{"step":1800,"acc":0.8425,"loss":0.4708,"byte":0.407},{"step":1850,"acc":0.84,"loss":0.4733,"byte":0.3995},{"step":1900,"acc":0.8396,"loss":0.4737,"byte":0.396},{"step":1950,"acc":0.8397,"loss":0.4735,"byte":0.3954},{"step":2000,"acc":0.8441,"loss":0.4692,"byte":0.418}];

// GPU (D=6180, gate-free, step 1775+) — subsample every 10 for readability
const gpuRaw = [{"step":1775,"acc":0.7375,"loss":0.5785,"lcx":-0.0007},{"step":1800,"acc":0.7675,"loss":0.5546,"lcx":-0.0015},{"step":1825,"acc":0.77,"loss":0.5418,"lcx":-0.0041},{"step":1850,"acc":0.765,"loss":0.549,"lcx":-0.0022},{"step":1875,"acc":0.8175,"loss":0.5438,"lcx":-0.0076},{"step":1900,"acc":0.7875,"loss":0.5443,"lcx":-0.0177},{"step":1925,"acc":0.775,"loss":0.5392,"lcx":-0.0246},{"step":1950,"acc":0.7825,"loss":0.5384,"lcx":-0.015},{"step":1975,"acc":0.7925,"loss":0.5434,"lcx":-0.0332},{"step":2000,"acc":0.805,"loss":0.5383,"lcx":-0.0043},{"step":2025,"acc":0.75,"loss":0.5447,"lcx":-0.0124},{"step":2050,"acc":0.75,"loss":0.5447,"lcx":-0.0234},{"step":2075,"acc":0.765,"loss":0.5445,"lcx":-0.0302}];

// GPU full EVAL data for lcx_delta plot
const gpuLcx = [{"step":1775,"lcx":0.0007},{"step":1780,"lcx":0.0005},{"step":1785,"lcx":0.0008},{"step":1790,"lcx":-0.007},{"step":1795,"lcx":-0.0038},{"step":1800,"lcx":-0.0015},{"step":1805,"lcx":0.0019},{"step":1810,"lcx":-0.0013},{"step":1815,"lcx":-0.0028},{"step":1820,"lcx":-0.0019},{"step":1825,"lcx":-0.0041},{"step":1830,"lcx":-0.0016},{"step":1835,"lcx":-0.0015},{"step":1840,"lcx":-0.0062},{"step":1845,"lcx":-0.0043},{"step":1850,"lcx":-0.0022},{"step":1855,"lcx":-0.0107},{"step":1860,"lcx":-0.0111},{"step":1865,"lcx":-0.0044},{"step":1870,"lcx":-0.0127},{"step":1875,"lcx":-0.0076},{"step":1880,"lcx":-0.0037},{"step":1885,"lcx":-0.0062},{"step":1890,"lcx":-0.0014},{"step":1895,"lcx":-0.0062},{"step":1900,"lcx":-0.0177},{"step":1905,"lcx":-0.0128},{"step":1910,"lcx":-0.0105},{"step":1915,"lcx":-0.0106},{"step":1920,"lcx":-0.0141},{"step":1925,"lcx":-0.0246},{"step":1930,"lcx":-0.0173},{"step":1935,"lcx":-0.0207},{"step":1940,"lcx":-0.0167},{"step":1945,"lcx":-0.0129},{"step":1950,"lcx":-0.015},{"step":1955,"lcx":-0.0129},{"step":1960,"lcx":-0.0074},{"step":1965,"lcx":-0.0198},{"step":1970,"lcx":-0.017},{"step":1975,"lcx":-0.0332},{"step":1980,"lcx":-0.0278},{"step":1985,"lcx":-0.0222},{"step":1990,"lcx":-0.016},{"step":1995,"lcx":-0.0105},{"step":2000,"lcx":-0.0043},{"step":2005,"lcx":-0.0154},{"step":2010,"lcx":-0.0095},{"step":2015,"lcx":-0.0222},{"step":2020,"lcx":-0.0211},{"step":2025,"lcx":-0.0124},{"step":2030,"lcx":-0.0145},{"step":2035,"lcx":-0.0069},{"step":2040,"lcx":-0.0106},{"step":2045,"lcx":-0.0215},{"step":2050,"lcx":-0.0234},{"step":2055,"lcx":-0.021},{"step":2060,"lcx":-0.0148},{"step":2065,"lcx":-0.011},{"step":2070,"lcx":-0.0068},{"step":2075,"lcx":-0.0302}];

// Per-bit data for heatmap
const perBitData = [
  {name:"CPU Alpha (2300s)", bits:[1.00,0.89,0.96,0.73,0.71,0.63,0.69,0.71], acc:0.795},
  {name:"CPU Beta (1100s)", bits:[1.00,0.89,0.96,0.73,0.71,0.63,0.69,0.71], acc:0.791},
  {name:"CPU tt=2 (200s)", bits:[1.00,0.83,0.96,0.71,0.68,0.57,0.66,0.62], acc:0.752},
  {name:"GPU gate-free (avg)", bits:[0.99,0.87,0.97,0.73,0.71,0.63,0.68,0.69], acc:0.785},
  {name:"D2000 longrun (2000s)", bits:[1.00,0.94,0.98,0.80,0.78,0.73,0.76,0.78], acc:0.844},
  {name:"Overnight d=1", bits:[0.99,0.79,0.96,0.71,0.67,0.58,0.63,0.59], acc:0.741},
  {name:"Overnight d=2", bits:[0.99,0.83,0.96,0.73,0.68,0.60,0.67,0.61], acc:0.759},
  {name:"Overnight d=4", bits:[0.99,0.81,0.96,0.72,0.67,0.57,0.61,0.60], acc:0.742},
];

// Architecture comparison (overnight)
const archResults = [
  {label:"d=1 D=2000", params:72274, acc:0.7406, loss:0.5726, byte:0.0624},
  {label:"d=2 D=2000", params:4078274, acc:0.7586, loss:0.5547, byte:0.1024},
  {label:"d=4 D=2000", params:12090274, acc:0.7419, loss:0.5713, byte:0.0624},
  {label:"d=2 D=4000", params:16156274, acc:0.7472, loss:0.5661, byte:0.0993},
];

// ============================================================
// CHARTS
// ============================================================

const colors = {
  cpuBeta: '#58a6ff',
  cpuTt2: '#f0883e',
  gpu: '#f778ba',
  longrun: '#7ee787',
  overnight: '#8b949e',
};

// 1. Learning Curves
let lcChart;
function buildLearningCurves(filter) {
  const datasets = [];

  if (filter === 'all' || filter === 'fineweb' || filter === 'cpu') {
    datasets.push({
      label: 'CPU Beta (D=618, tt=1, LCX ON)',
      data: cpuBeta.map(d => ({x: d.step, y: d.acc * 100})),
      borderColor: colors.cpuBeta, backgroundColor: colors.cpuBeta + '33',
      borderWidth: 2, pointRadius: 0, tension: 0.3,
    });
  }
  if (filter === 'all' || filter === 'fineweb' || filter === 'cpu') {
    datasets.push({
      label: 'CPU tt=2 (D=618, tt=2, from Beta ckpt)',
      data: cpuTt2.map(d => ({x: d.step + 1100, y: d.acc * 100})),
      borderColor: colors.cpuTt2, backgroundColor: colors.cpuTt2 + '33',
      borderWidth: 2, pointRadius: 2, tension: 0.3, borderDash: [5, 3],
    });
  }
  if (filter === 'all' || filter === 'fineweb') {
    datasets.push({
      label: 'GPU gate-free (D=6180, tt=1, 50M params)',
      data: gpuRaw.map(d => ({x: d.step, y: d.acc * 100})),
      borderColor: colors.gpu, backgroundColor: colors.gpu + '33',
      borderWidth: 2, pointRadius: 2, tension: 0.3,
    });
  }
  if (filter === 'all' || filter === 'fineweb') {
    datasets.push({
      label: 'D=2000 longrun (depth=2, tt=1, 4.1M params)',
      data: depth2Longrun.map(d => ({x: d.step, y: d.acc * 100})),
      borderColor: colors.longrun, backgroundColor: colors.longrun + '33',
      borderWidth: 2, pointRadius: 0, tension: 0.3,
    });
  }
  // Alpha ceiling line
  datasets.push({
    label: 'Alpha CPU ceiling (79.5%)',
    data: [{x: 0, y: 79.5}, {x: 2100, y: 79.5}],
    borderColor: '#484f58', borderWidth: 1, borderDash: [8, 4],
    pointRadius: 0,
  });

  return datasets;
}

function showCurves(filter) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  lcChart.data.datasets = buildLearningCurves(filter);
  lcChart.update();
}

lcChart = new Chart(document.getElementById('learningCurves'), {
  type: 'scatter',
  data: { datasets: buildLearningCurves('all') },
  options: {
    responsive: true,
    plugins: { legend: { labels: { color: '#c9d1d9', font: {size: 11} } } },
    scales: {
      x: { title: { display: true, text: 'Steps', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' } },
      y: { title: { display: true, text: 'Eval Bit Accuracy (%)', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' }, min: 68, max: 86 },
    },
    showLine: true,
  },
});

// 2. Params vs Accuracy scatter
new Chart(document.getElementById('paramsVsAcc'), {
  type: 'scatter',
  data: {
    datasets: [{
      label: 'Experiments (best eval)',
      data: [
        {x: 72274, y: 74.1, label: 'd=1'},
        {x: 406000, y: 79.5, label: 'Alpha CPU'},
        {x: 515000, y: 79.1, label: 'Beta CPU'},
        {x: 4078274, y: 84.4, label: 'D2000 longrun'},
        {x: 12090274, y: 74.2, label: 'd=4'},
        {x: 16156274, y: 74.7, label: 'D=4000'},
        {x: 50000000, y: 78.5, label: 'GPU'},
      ],
      backgroundColor: [colors.overnight, colors.cpuBeta, colors.cpuBeta, colors.longrun, colors.overnight, colors.overnight, colors.gpu],
      pointRadius: 8,
      pointHoverRadius: 12,
    }],
  },
  options: {
    responsive: true,
    plugins: {
      legend: { display: false },
      tooltip: {
        callbacks: {
          label: (ctx) => {
            const d = ctx.raw;
            return `${d.label}: ${d.y}% (${(d.x/1e6).toFixed(1)}M params)`;
          }
        }
      }
    },
    scales: {
      x: { type: 'logarithmic', title: { display: true, text: 'Parameters (log)', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e', callback: v => v >= 1e6 ? (v/1e6)+'M' : (v/1e3)+'K' } },
      y: { title: { display: true, text: 'Best Eval Bit Acc (%)', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' }, min: 70, max: 86 },
    },
  },
});

// 3. Heatmap
const heatDiv = document.getElementById('heatmap');
let html = '<div class="heatmap"><div class="heatlabel"></div>';
for (let i = 0; i < 8; i++) html += `<div class="heatcell" style="color:#58a6ff;font-weight:bold">bit${i}</div>`;
for (const row of perBitData) {
  html += `<div class="heatlabel">${row.name}</div>`;
  for (let i = 0; i < 8; i++) {
    const v = row.bits[i];
    const r = Math.round(255 * (1 - v));
    const g = Math.round(255 * v);
    const bg = `rgba(${r > 100 ? r : 0}, ${g > 100 ? g : 60}, 40, 0.6)`;
    html += `<div class="heatcell" style="background:${bg}">${(v*100).toFixed(0)}%</div>`;
  }
}
html += '</div>';
heatDiv.innerHTML = html;

// 4. Architecture comparison
new Chart(document.getElementById('archCompare'), {
  type: 'bar',
  data: {
    labels: archResults.map(r => r.label),
    datasets: [
      { label: 'Eval Accuracy (%)', data: archResults.map(r => r.acc * 100), backgroundColor: '#58a6ff88', borderColor: '#58a6ff', borderWidth: 1 },
      { label: 'Byte Match (%)', data: archResults.map(r => r.byte * 100), backgroundColor: '#7ee78788', borderColor: '#7ee787', borderWidth: 1 },
    ],
  },
  options: {
    responsive: true,
    plugins: { legend: { labels: { color: '#c9d1d9' } } },
    scales: {
      x: { ticks: { color: '#8b949e' }, grid: { color: '#21262d' } },
      y: { ticks: { color: '#8b949e' }, grid: { color: '#21262d' }, min: 0, max: 80 },
    },
  },
});

// 5. Loss curves
new Chart(document.getElementById('lossCurves'), {
  type: 'scatter',
  data: {
    datasets: [
      { label: 'CPU Beta', data: cpuBetaLoss.map(d => ({x:d.step, y:d.loss})), borderColor: colors.cpuBeta, borderWidth: 2, pointRadius: 0, tension: 0.3, showLine: true },
      { label: 'D2000 longrun', data: depth2Longrun.map(d => ({x:d.step, y:d.loss})), borderColor: colors.longrun, borderWidth: 2, pointRadius: 0, tension: 0.3, showLine: true },
    ],
  },
  options: {
    responsive: true,
    plugins: { legend: { labels: { color: '#c9d1d9', font: {size: 11} } } },
    scales: {
      x: { title: { display: true, text: 'Steps', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' } },
      y: { title: { display: true, text: 'Eval Loss', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' }, reverse: true },
    },
    showLine: true,
  },
});

// 6. Byte accuracy
new Chart(document.getElementById('byteCurves'), {
  type: 'scatter',
  data: {
    datasets: [
      { label: 'CPU Beta', data: cpuBetaLoss.map(d => ({x:d.step, y:d.byte*100})), borderColor: colors.cpuBeta, borderWidth: 2, pointRadius: 0, tension: 0.3, showLine: true },
      { label: 'D2000 longrun', data: depth2Longrun.map(d => ({x:d.step, y:d.byte*100})), borderColor: colors.longrun, borderWidth: 2, pointRadius: 0, tension: 0.3, showLine: true },
    ],
  },
  options: {
    responsive: true,
    plugins: { legend: { labels: { color: '#c9d1d9', font: {size: 11} } } },
    scales: {
      x: { title: { display: true, text: 'Steps', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' } },
      y: { title: { display: true, text: 'Byte Match (%)', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' }, min: 0 },
    },
    showLine: true,
  },
});

// 7. LCX Delta
new Chart(document.getElementById('lcxDelta'), {
  type: 'scatter',
  data: {
    datasets: [{
      label: 'lcx_delta',
      data: gpuLcx.map(d => ({x: d.step, y: d.lcx})),
      borderColor: '#f778ba',
      backgroundColor: gpuLcx.map(d => d.lcx < 0 ? '#7ee78788' : '#f8514988'),
      pointRadius: 4, showLine: true, borderWidth: 1, tension: 0.2,
    }, {
      label: 'Zero line',
      data: [{x: 1775, y: 0}, {x: 2080, y: 0}],
      borderColor: '#484f58', borderWidth: 1, borderDash: [4, 4], pointRadius: 0, showLine: true,
    }],
  },
  options: {
    responsive: true,
    plugins: { legend: { display: false } },
    scales: {
      x: { title: { display: true, text: 'GPU Step', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' } },
      y: { title: { display: true, text: 'lcx_delta (neg = helping)', color: '#8b949e' }, grid: { color: '#21262d' }, ticks: { color: '#8b949e' } },
    },
  },
});

</script>
</body>
</html>
