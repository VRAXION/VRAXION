<svg xmlns="http://www.w3.org/2000/svg" width="980" height="260" viewBox="0 0 980 260">
  <rect width="980" height="260" fill="#0b0f14"/>
  <style>
    .box { fill:#111827; stroke:#3b82f6; stroke-width:2; rx:10; ry:10; }
    .box2 { fill:#0f172a; stroke:#22c55e; stroke-width:2; rx:10; ry:10; }
    .txt { font-family:Consolas,monospace; font-size:14px; fill:#e5e7eb; }
    .lbl { font-family:Consolas,monospace; font-size:12px; fill:#93c5fd; }
    .arrow { stroke:#93c5fd; stroke-width:2; fill:none; marker-end:url(#arrowhead); }
    .arrow2 { stroke:#22c55e; stroke-width:2; fill:none; marker-end:url(#arrowhead2); }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#93c5fd"/>
    </marker>
    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
    </marker>
  </defs>

  <!-- Boxes -->
  <rect class="box" x="30" y="30" width="160" height="60"/>
  <text class="txt" x="50" y="65">Raw Token</text>
  <text class="lbl" x="50" y="82">(scalar input)</text>

  <rect class="box" x="230" y="30" width="180" height="60"/>
  <text class="txt" x="250" y="55">Input Projection</text>
  <text class="lbl" x="250" y="75">Linear: 1 â†’ slot_dim</text>

  <rect class="box" x="450" y="30" width="140" height="60"/>
  <text class="txt" x="470" y="65">GRU Cell</text>

  <rect class="box2" x="640" y="20" width="300" height="90"/>
  <text class="txt" x="660" y="50">Ring Memory (Circle)</text>
  <text class="lbl" x="660" y="70">Read + Write each step</text>

  <rect class="box" x="640" y="140" width="220" height="60"/>
  <text class="txt" x="660" y="175">Expert Head / Logits</text>

  <!-- Arrows -->
  <path class="arrow" d="M190 60 L230 60"/>
  <path class="arrow" d="M410 60 L450 60"/>
  <path class="arrow" d="M590 60 L640 60"/>
  <path class="arrow" d="M770 110 L770 140"/>

  <!-- Ring read context back into GRU -->
  <path class="arrow2" d="M790 20 C790 5, 520 5, 520 30"/>
  <text class="lbl" x="555" y="16">Ring read (context)</text>
</svg>
